<div class="container" data-controller="new-complaint">
  <div data-new-complaint-target="initialComplaintForm">
    <h3>Escreva sua reclamação</h3>
    <p class="mb-4"><strong>Campos com * são obrigatorios</strong></p>
    <%= simple_form_for @complaint, html: { class: 'form-horizontal' } do |f| %>
      <div class="form-group mb-4">
        <%= f.label :company_id, 'Selecione uma empresa:', class: 'control-label' %>
        <%= f.collection_select :company_id, Company.all, :id, :company_name, { include_blank: "Selecione uma empresa" }, { class: 'form-control' } %>
      </div>
      <%= render 'components/new_complaint', f: f %>
      <div class="form-group my-4">
        <%= f.submit "Submit Complaint", class: 'btn btn-primary' %>
      </div>
    <% end %>
  </div>
  <div class="mt-4">
    <div  data-action="click->new-complaint#showFormComplaint" class="d-flex justify-content-center">
      <button class="btn btn-info" data-new-complaint-target="btnTargetToggle">Clique aqui se não encontrou a empresa</button>
    </div>
    <%= simple_form_for @complaint, html: { class: 'form-horizontal' } do |f| %>
      <div class="mt-4 d-none" data-new-complaint-target="complaintCompanySelect">
        <h3>Especifique qual empresa deseja reclamar abaixo:</h3>
        <p class="mb-4"><strong>Campos com * são obrigatorios</strong></p>
        <%= f.fields_for :company do |company_fields| %>
          <div class="form-group">
            <%= company_fields.input :company_name, label: "Nome da empresa", class: "form-control" %>
          </div>
          <div class="form-group my-4">
            <%= company_fields.label "Categoria da empresa", required: true %>
            <%= company_fields.select :company_category, options_for_select([["Selecione uma categoria", ""]] + Company::COMPANY_CATEGORY.map { |category| [category, category] }, selected: @complaint.company&.company_category&.first), {}, { class: 'form-control', name: 'complaint[company_attributes][company_category][]' } %>
          </div>
          <div class="form-group">
            <%= company_fields.input :company_city, label: "Cidade da empresa", class: "form-control" %>
          </div>
          <div class="form-group">
            <%= company_fields.input :company_state, label: "Estado da empresa", class: "form-control" %>
          </div>
          <div class="form-group">
            <h4>Social Media Links</h4>
            <p>Insira pelo menos <strong>um link ou username</strong> de rede social</P>
            <%= company_fields.fields_for :company_social_media do |social| %>
              <div class="social-media-group">
                <%= social.input :facebook, class: "form-control" %>
                <%= social.input :twitter, class: "form-control" %>
                <%= social.input :linkedin, class: "form-control" %>
                <%= social.input :instagram, class: "form-control" %>
                <%= social.input :youtube, class: "form-control" %>
                <%= social.input :tiktok, class: "form-control" %>
              </div>
            <% end %>
          </div>
          <div class="mt-4">
            <h3>Escreva sua reclamação</h3>
            <%= render 'components/new_complaint', f: f %>
          </div>
        <% end %>
        <div class="form-group mt-4">
          <%= f.submit "Submit Complaint", class: 'btn btn-primary' %>
        </div>
      </div>
    </div>
  <% end %>
</div>
